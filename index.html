<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="google" content="notranslate">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">
    <title>Файл-Менеджер</title>
  </head>
  <body>
    <div id="app">

      <!-- Шапка -->
      <nav class="text-white d-flex py-2" style="background-color: #e3f2fd;">
        <!-- <h5 class="text-white">Введение в государственную службу</h5>

        <div class="input-form">
          <input type="text" class="input" v-model="inputSearch" @keyup="search()">
          <img src="icons/search.svg" v-if="inputSearch === ''">
        </div>

        <form id="frm" action="php/uploadFile.php" method="post" enctype="multipart/form-data">
          <input id="file" ref="file" type=file name="file" class="d-none">
        </form>
        <div

        >
          <button class="px-3 btn-green h-100" @click="$refs.file.click()">
            <img src="icons/upload.svg" class="me-1">
            <span>ЗАГРУЗИТЬ</span>
          </button>
        </div>

        <button type="button" class="ms-3 px-3 btn-green" data-bs-toggle="modal" data-bs-target="#exampleModal"
          @click="model = 'create'"
        >
          <img src="icons/plus.svg" class="me-1">
          <span>СОЗДАТЬ</span>
        </button> -->
        <div class="container">
          <div class="row">
            <h6 class="text-white col-3 mt-2">Введение в гос. службу</h6>

            <div class="col-9 ps-0 d-flex">
              <div class="input-form ms-1 w-60">
                <input type="text" class="input" v-model="inputSearch" @keyup="search()">
                <img src="icons/search.svg" v-if="inputSearch === ''">
              </div>

              <form id="frm" action="php/uploadFile.php" method="post" enctype="multipart/form-data">
                <input id="file" ref="file" type=file name="file" class="d-none">
              </form>

              <button class="px-3 btn-green h-100" @click="$refs.file.click()">
                <img src="icons/upload.svg" class="me-1">
                <span>ЗАГРУЗИТЬ</span>
              </button>

              <button type="button" class="ms-3 me-4 px-3 btn-green h-100" data-bs-toggle="modal" data-bs-target="#exampleModal"
                @click="model = 'create'"
              >
                <img src="icons/plus.svg" class="me-1">
                <span>СОЗДАТЬ</span>
              </button>

              <div class="ms-auto">
                <button class="px-3 btn-green h-100">
                  <img src="icons/sign-in.svg" class="me-1 sign-in">
                  <span>Войти</span>
                </button>
              </div>
            </div>

          </div>
        </div>
      </nav>
      <!-- ------- -->

      <main class="container d-flex pt-4">
        <aside class="col-3">
          <h6>Навигация</h6>

          <ul type="none" id="sidebar-folders">

            <li
              v-for="(item, index) in mainFolders"
              @click="showFolder(item)"
            >
              <img src="icons/folder.svg">
              <span>{{ item.title }}</span>
            </li>

          </ul>
        </aside>

        <section class="col-9 mb-3">
          <div id="path">
            <button
              class="path bg-green text-white py-1 mb-3 me-2"
              v-for="(item, index) in path"
              @click="comeBack(index)"
            >
              {{ item }}
            </button>
          </div>

          <article>

            <div class="item px-2 text-left"
              v-for="(item, index) in items"
            >
              <div class="dropdown">
                <button class="more" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false"> <img src="icons/more.svg"> </button>
                <!-- if -->
                <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1"
                  v-if="item.type === 'folder'"
                >
                  <li class="dropdown-item" data-bs-toggle="modal" data-bs-target="#exampleModal"
                    @click="model='edit', basicName=item.title, inputModal=item.title"
                  >
                    Изменить
                  </li>
                  <li class="dropdown-item" data-bs-toggle="modal" data-bs-target="#deleteModal"
                    @click="selItem = item, model = 'deleteFolder'"
                  >
                    Удалить
                  </li>
                  <li class="dropdown-item">Скрыть</li>
                </ul>
                <!-- else -->
                <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1"
                  v-else
                >
                <li class="dropdown-item"
                  @click="downloadFile(item.title)"
                >
                  Скачать
                </li>
                <li class="dropdown-item" data-bs-toggle="modal" data-bs-target="#exampleModal"
                  @click="model='edit', basicName=item.title, inputModal=item.title"
                >
                  Изменить
                </li>
                <li class="dropdown-item" data-bs-toggle="modal" data-bs-target="#deleteModal"
                  @click="selItem = item, model = 'deleteFile'"
                >
                  Удалить
                </li>
                <li class="dropdown-item">Скрыть</li>
                </ul>
                <!-- endif -->
              </div>

              <div class="d-flex flex-column"
                @click="showFolder(item)"
                v-bind:title="item.title"
              >
                <img :src="'icons/'+item.type+item.extension+'.svg'" class="my-3 ml-auto" :class="{ fileImg: item.type === 'file' }">
                <hr>
                <strong> {{ item.title }} </strong>
                <small v-if="item.type === 'folder'"> Содержимое: {{ item.items }} </small>
              </div>
            </div>

          </article>
        </section>
      </main>

      <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true" ref="modal">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header text-white rounded-0">
              <h5 class="modal-title" id="exampleModalLabel" v-if="model === 'create'">Создание каталога</h5>
              <h5 class="modal-title" id="exampleModalLabel" v-if="model === 'edit'">Редактирование каталога</h5>
              <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <label>Навзание</label>
              <input type="text" class="form-control" id="inputModal" v-model="inputModal" @change="inputValid()" v-if="model === 'create'">
              <input type="text" class="form-control" id="inputModal" v-model="inputModal" @change="inputValid()" v-if="model === 'edit'">
            </div>
            <div class="modal-footer pt-0">
              <button type="button" class="btn-green py-1" data-bs-dismiss="modal">Закрыть</button>
              <button type="button" class="btn-green py-1" @click="createFolder()" v-if="model === 'create'" ref="close">Создать</button>
              <button type="button" class="btn-green py-1" @click="rename()" v-if="model === 'edit'" ref="close">Редактировать</button>
            </div>
          </div>
        </div>
      </div>

      <div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true" ref="modal">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header text-white rounded-0">
              <h5 class="modal-title" id="deleteModalLabel" v-if="model === 'deleteFile'">Удалить файл</h5>
              <h5 class="modal-title" id="deleteModalLabel" v-if="model === 'deleteFolder'">Удалить каталог</h5>
              <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <span v-if="model === 'deleteFile'">Вы уверены что хотите удалить файл?</span>
              <span v-if="model === 'deleteFolder'">Вы уверены что хотите удалить каталог?</span>
            </div>
            <div class="modal-footer pt-0">
              <button type="button" class="btn-green py-1" data-bs-dismiss="modal">Отмена</button>
              <button type="button" class="btn-green btn-delete py-1" data-bs-dismiss="modal" @click="removeFile()" v-if="model === 'deleteFile'">Удалить</button>
              <button type="button" class="btn-green btn-delete py-1" data-bs-dismiss="modal" @click="removeFolder()" v-if="model === 'deleteFolder'">Удалить</button>
            </div>
          </div>
        </div>
      </div>

    </div>
  </body>
  <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
  <script src="http://malsup.github.com/jquery.form.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js" integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js" charset="utf-8"></script>
  <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
  <script src="script.js" charset="utf-8"></script>
</html>
